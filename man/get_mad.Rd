% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/thresholding.R
\name{get_mad}
\alias{get_mad}
\title{Find Points Closest to n*MAD from the Median}
\usage{
get_mad(x, y, n = 3, direction = c("upper", "lower", "both"))
}
\arguments{
\item{x}{A numeric vector of x-values (same length as \code{y}).}

\item{y}{A numeric vector of y-values (same length as \code{x}).}

\item{n}{Numeric value for the number of MADs to use.
3 by default.}

\item{direction}{One of "upper", "lower", or "both":
\itemize{
\item \strong{"upper"}: Find the data point nearest \eqn{\mathrm{median}(y) + n \times \mathrm{MAD}(y)}.
\item \strong{"lower"}: Find the data point nearest \eqn{\mathrm{median}(y) - n \times \mathrm{MAD}(y)}.
\item \strong{"both"}: Return two points: one near the upper boundary and one near the lower boundary.
}}
}
\value{
A list with:
\itemize{
\item \code{median_y}: The median of \code{y}.
\item \code{mad_y}: The median absolute deviation of \code{y}.
\item \code{upper_threshold}: \eqn{\mathrm{median}(y) + n \times \mathrm{MAD}(y)}.
\item \code{lower_threshold}: \eqn{\mathrm{median}(y) - n \times \mathrm{MAD}(y)}.
\item \code{break_xs}: The x-values closest to the chosen threshold(s).
\item \code{break_ys}: The corresponding y-values.
\item \code{indices}: The indices in \verb{x,y} for these breakpoints.
}
}
\description{
This function identifies the point(s) in the data whose \code{y}-value is
\emph{closest} to \eqn{\mathrm{median}(y) \pm n \times \mathrm{MAD}(y)}.
In other words, it picks an actual data point near the "(n) MAD boundary"
(upper, lower, or both).
}
\details{
\enumerate{
\item We compute:
\deqn{
     m = \mathrm{median}(y), \quad
     a = \mathrm{MAD}(y)
   }
\item Define:
\deqn{
     \mathrm{upper} = m + (n)a, \quad
     \mathrm{lower} = m - (n)a
   }
\item For each threshold requested (\emph{upper}, \emph{lower}, or \emph{both}),
we find the index \eqn{i} that minimizes
\eqn{| y[i] - \mathrm{threshold} |}.
\item We return those \code{x[i]}, \code{y[i]} as the "breakpoints."
}

This is a simple “rule-of-thumb” method: once the data cross
roughly \eqn{\pm n \times \mathrm{MAD}} from the center, we call that a
"significant departure." It doesn't use ranking or second derivatives—just
a robust measure of spread to define the boundary.
}
\examples{
x_data <- seq(500)
# Exponential data
y_data <- 1 * exp(0.02 * (x_data - 1))

# Sigmoidal
y_data2 <- 1 / (1 + exp(-0.02 * (x_data - 250)))

res_mad <- get_mad(x_data, y_data, n = 3, direction = "upper")
res_mad$break_xs
res_mad$break_ys

res_mad <- get_mad(x_data, y_data2, n = 3, direction = "upper")
res_mad$break_xs
res_mad$break_ys
}
\seealso{
\code{\link[stats]{mad}}
}
\author{
Jared Andrews
}
